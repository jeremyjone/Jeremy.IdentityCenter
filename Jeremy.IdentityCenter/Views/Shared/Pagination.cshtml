@using Jeremy.IdentityCenter.Business.Helpers
@model Jeremy.IdentityCenter.Business.Models.Pagination
@{
    var currentPage = PaginationHelpers.GetCurrentPage(Context.Request.Query["page"]);
    var totalCount = PaginationHelpers.GetTotalPages(Model.PageSize, Model.TotalCount);
    var minPage = PaginationHelpers.GetMinPageToRender(Model.MaxPages, totalCount, currentPage);
    var maxPage = PaginationHelpers.GetMaxPageToRender(Model.MaxPages, totalCount, currentPage);
}

@if (currentPage <= maxPage)
{
<nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">

        @if (Model.EnableSearch)
        {
<li class="page-item"><a class="page-link" asp-action="@Model.Action" asp-route-page="1" asp-route-search="@Model.Search">首页</a></li> }
                else
                {
<li class="page-item"><a class="page-link" asp-action="@Model.Action" asp-route-page="1">首页</a></li>}

        @if (PaginationHelpers.ShowLeftPagerButton(Model.MaxPages, totalCount, currentPage))
        {
            if (Model.EnableSearch)
            {
<li class="page-item"><a class="page-link" asp-action="@Model.Action" asp-route-page="@(minPage - 1)" asp-route-search="@Model.Search">...</a></li> }
                    else
                    {
<li class="page-item"><a class="page-link" asp-action="@Model.Action" asp-route-page="@(minPage - 1)">...</a></li>}
                }

        @for (var i = minPage; i <= maxPage; i++)
        {
            if (Model.EnableSearch)
            {
                if (PaginationHelpers.IsActivePage(currentPage, i))
                {
<li class="page-item active"><a class="page-link" asp-action="@Model.Action" asp-route-page="@i" asp-route-search="@Model.Search">@i</a></li> }
                        else
                        {
<li class="page-item"><a class="page-link" asp-action="@Model.Action" asp-route-page="@i" asp-route-search="@Model.Search">@i</a></li> }
                    }
                    else
                    {
                        if (PaginationHelpers.IsActivePage(currentPage, i))
                        {
<li class="page-item active"><a class="page-link" asp-action="@Model.Action" asp-route-page="@i">@i</a></li> }
                        else
                        {
<li class="page-item"><a class="page-link" asp-action="@Model.Action" asp-route-page="@i">@i</a></li>}
                    }
                }

        @if (PaginationHelpers.ShowRightPagerButton(Model.MaxPages, totalCount, currentPage))
        {
            if (Model.EnableSearch)
            {
<li class="page-item"><a class="page-link" asp-action="@Model.Action" asp-route-page="@(maxPage + 1)" asp-route-search="@Model.Search">...</a></li> }
                    else
                    {
<li class="page-item"><a class="page-link" asp-action="@Model.Action" asp-route-page="@(maxPage + 1)">...</a></li>}
                }

        @if (Model.EnableSearch)
        {
<li class="page-item"><a class="page-link" asp-action="@Model.Action" asp-route-page="@totalCount" asp-route-search="@Model.Search">尾页</a></li> }
                else
                {
<li class="page-item"><a class="page-link" asp-action="@Model.Action" asp-route-page="@totalCount">尾页</a></li>}
    </ul>
</nav>}